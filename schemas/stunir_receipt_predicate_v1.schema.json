{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "urn:stunir:schema:receipt-predicate:v1",
  "title": "STUNIR receipt predicate v1",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "materials": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "uri": {"type": "string", "minLength": 1},
          "digest": {
            "type": "object",
            "minProperties": 1,
            "patternProperties": {
              "^[A-Za-z0-9][A-Za-z0-9_-]{0,31}$": {"type": "string", "pattern": "^[0-9a-f]{16,256}$"}
            },
            "additionalProperties": false
          }
        },
        "required": ["uri", "digest"]
      }
    },
    "specClosure": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "manifest": {
          "type": "object",
          "additionalProperties": false,
          "properties": {"uri": {"type": "string", "minLength": 1}},
          "required": ["uri"]
        }
      },
      "required": ["manifest"]
    },
    "buildPolicy": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "sourceDateEpoch": {"type": "integer"}
      }
    },
    "ir": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "rebuildCommand": {
          "type": "array",
          "minItems": 1,
          "items": {"type": "string", "minLength": 1}
        },
        "output": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "uri": {"type": "string", "minLength": 1},
            "digest": {"type": "object", "minProperties": 1},
            "canonicalization": {"type": "string"}
          },
          "required": ["uri", "digest"]
        }
      },
      "required": ["rebuildCommand", "output"]
    },
    "codegen": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "rebuildCommand": {
          "type": "array",
          "minItems": 1,
          "items": {"type": "string", "minLength": 1}
        },
        "outputs": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "manifest": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "uri": {"type": "string", "minLength": 1},
                "digest": {"type": "object", "minProperties": 1}
              },
              "required": ["uri", "digest"]
            }
          },
          "required": ["manifest"]
        }
      },
      "required": ["rebuildCommand", "outputs"]
    }
  },
  "required": ["materials", "specClosure", "ir", "codegen"]
}
