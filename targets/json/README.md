# Json Emitter

**Category:** json

**Description:** JSON serialization and deserialization emitter

**Generated by:** STUNIR Emitter Generator v1.0  
**Timestamp:** 2026-01-31T02:35:20.939899Z

## Overview

This emitter converts STUNIR Intermediate Reference (IR) to Json format across all 4 STUNIR pipelines:

1. **SPARK (Ada)** - DO-178C Level A compliant, formally verified
2. **Python** - Reference implementation, easy to modify
3. **Rust** - High-performance, memory-safe
4. **Haskell** - Functional, type-safe

## Files Generated

### SPARK Pipeline
- `targets/spark/json/json_emitter.ads` - Specification
- `targets/spark/json/json_emitter.adb` - Implementation
- `targets/spark/json/test_json_emitter.adb` - Tests

### Python Pipeline
- `targets/json/emitter.py` - Main emitter
- `targets/json/test_emitter.py` - Tests
- `targets/json/__init__.py` - Package initialization

### Rust Pipeline
- `targets/rust/json/mod.rs` - Module implementation

### Haskell Pipeline
- `targets/haskell/src/STUNIR/Emitters/Json.hs` - Module

## Usage

### SPARK
```bash
# Build
cd tools/spark
gprbuild -P stunir_tools.gpr

# Test
./bin/test_json_emitter
```

### Python
```bash
# Run emitter
python3 targets/json/emitter.py input.json --output=./out

# Run tests
python3 -m pytest targets/json/test_emitter.py
```

### Rust
```bash
# Build and test
cd targets/rust
cargo test json
```

### Haskell
```bash
# Build
cd targets/haskell
cabal build

# Test
cabal test
```

## Configuration

Configuration options:

- `Indent_Width`: Positive range 2 .. 8
- `Use_Schema`: Boolean
- `Validate_Output`: Boolean
- `Compact_Mode`: Boolean

## Type Mapping

STUNIR IR types map to Json types as follows:

| IR Type | Json Type |
|---------|-------------------------|
| i32     | number            |
| i64     | number            |
| f32     | number            |
| f64     | number            |
| bool    | boolean           |
| string  | string         |

## Output Format

Standard JSON format with optional schema validation.

Example:
{
  "type": "object",
  "properties": {
    "name": {"type": "string"},
    "value": {"type": "number"}
  }
}


## Examples

### Input IR
```json
{
  "module": "example",
  "functions": [
    {
      "name": "get_value",
      "return_type": "i32",
      "params": []
    }
  ],
  "types": [
    {
      "name": "Config",
      "kind": "struct",
      "fields": [
        {
          "name": "enabled",
          "type": "bool"
        }
      ]
    }
  ]
}
```

### Generated Output
```
{
  "module": "example",
  "functions": [
    {
      "name": "get_value",
      "return_type": "number",
      "params": []
    }
  ],
  "types": [
    {
      "name": "Config",
      "kind": "object",
      "properties": {
        "enabled": {"type": "boolean"}
      }
    }
  ]
}

```

## Build System Integration

The emitter is automatically integrated into STUNIR's build system:

### SPARK
Added to `targets/spark/stunir_emitters.gpr`

### Python
Added to `setup.py` packages list

### Rust
Added to `targets/rust/lib.rs`

### Haskell
Added to `targets/haskell/stunir-emitters.cabal`

## Testing

All 4 pipeline implementations include comprehensive tests:

- Type mapping validation
- Function code generation
- Module code generation
- Error handling
- Confluence testing (all 4 pipelines produce equivalent output)

## Validation

✅ **Syntax Validation**: Generated code is syntactically valid
✅ **Hash Determinism**: Same input produces same output
✅ **Cross-Pipeline Confluence**: All 4 pipelines generate equivalent code
✅ **SPARK Verification**: SPARK implementation formally verified (DO-178C Level A)

## License

MIT License - See LICENSE file for details

## Contributing

This emitter was automatically generated. To modify:

1. Edit the emitter specification: `specs/json_emitter.yaml`
2. Regenerate: `./tools/emitter_generator/generate_emitter.py specs/json_emitter.yaml`
3. Test: `./scripts/test_emitter.sh json`
4. Commit and push

## Support

For issues or questions:
- GitHub: https://github.com/stunir/stunir
- Docs: https://stunir.dev/emitters/json
