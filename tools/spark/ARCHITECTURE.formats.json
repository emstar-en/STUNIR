{
  "schema_version": "2.2.0",
  "section": "formats",
  "last_updated": "2026-02-06",
  "status": "active_development",
  "data_formats": {
    "manifest_v1": {
      "description": "File inventory with metadata",
      "schema_snippet": {
        "type": "object",
        "required": [
          "generated_at",
          "root",
          "files"
        ],
        "properties": {
          "generated_at": {
            "type": "string",
            "format": "date-time"
          },
          "root": {
            "type": "string"
          },
          "files": {
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "path",
                "hash"
              ],
              "properties": {
                "path": {
                  "type": "string"
                },
                "size": {
                  "type": "integer"
                },
                "hash": {
                  "type": "string",
                  "pattern": "^[a-f0-9]{64}$"
                }
              }
            }
          }
        }
      },
      "example": {
        "generated_at": "2026-02-06T12:00:00Z",
        "root": "/project/src",
        "files": [
          {
            "path": "main.c",
            "size": 1024,
            "modified": "2026-02-05T10:00:00Z",
            "hash": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
          }
        ]
      }
    },
    "spec_v1": {
      "description": "Canonical function specification",
      "schema_snippet": {
        "type": "object",
        "required": [
          "schema_version",
          "module"
        ],
        "properties": {
          "schema_version": {
            "type": "string"
          },
          "module": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string"
              },
              "functions": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "name",
                    "return_type"
                  ],
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "return_type": {
                      "type": "string"
                    },
                    "params": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "type": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "example": {
        "schema_version": "1.0.0",
        "module": {
          "name": "example",
          "functions": [
            {
              "name": "add",
              "return_type": "int",
              "params": [
                {
                  "name": "a",
                  "type": "int"
                },
                {
                  "name": "b",
                  "type": "int"
                }
              ]
            }
          ]
        }
      }
    },
    "ir_v1": {
      "description": "Intermediate representation",
      "schema_snippet": {
        "type": "object",
        "required": [
          "ir_version",
          "functions"
        ],
        "properties": {
          "ir_version": {
            "type": "string"
          },
          "functions": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "steps": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      },
      "example": {
        "schema_version": "1.0.0",
        "ir_version": "1.0",
        "module_name": "example",
        "functions": [
          {
            "name": "add",
            "return_type": "int",
            "args": [
              "int a",
              "int b"
            ],
            "steps": [
              "return a + b;"
            ]
          }
        ]
      }
    },
    "receipt_v1": {
      "description": "Verification receipt",
      "schema_snippet": {
        "type": "object",
        "required": [
          "spec_hash",
          "source_index"
        ],
        "properties": {
          "spec_hash": {
            "type": "string"
          },
          "source_index": {
            "type": "string"
          },
          "links": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "from": {
                  "type": "string"
                },
                "to": {
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "example": {
        "spec_hash": "def456",
        "source_index": "manifest_hash",
        "links": [
          {
            "from": "source.c",
            "to": "generated.cpp"
          }
        ]
      }
    }
  },
  "schema_registry": {
    "description": "Registry of schema identifiers and their canonical versions",
    "entries": [
      {
        "id": "manifest_v1",
        "version": "1.0",
        "status": "stable",
        "tools": [
          "file_indexer"
        ]
      },
      {
        "id": "spec_v1",
        "version": "1.0",
        "status": "stable",
        "tools": [
          "extraction_to_spec",
          "spec_validate",
          "func_dedup",
          "type_normalize",
          "type_map",
          "sig_gen_cpp",
          "sig_gen_rust"
        ]
      },
      {
        "id": "ir_v1",
        "version": "1.0",
        "status": "stable",
        "tools": [
          "stunir_spec_to_ir_main"
        ]
      },
      {
        "id": "receipt_v1",
        "version": "1.0",
        "status": "planned",
        "tools": [
          "receipt_generate"
        ]
      }
    ]
  },
  "versioning_policy": {
    "schema_version_field": "schema_version",
    "compatibility": "Minor versions are backward compatible; major versions may break",
    "migration": "Adapters may be provided for one major version back",
    "validation": "Always validate version before processing"
  },
  "validation_rules": {
    "mandatory_fields": "Reject missing required fields",
    "unknown_fields": "Allowed unless strict mode is enabled",
    "ordering": "Field order is not significant",
    "numeric_ranges": "Reject values outside schema ranges when specified",
    "string_encoding": "UTF-8 only"
  },
  "examples": {
    "minimal_spec": {
      "schema_version": "1.0.0",
      "module": {
        "name": "m",
        "functions": [
          {
            "name": "f",
            "return_type": "int",
            "params": []
          }
        ]
      }
    },
    "minimal_manifest": {
      "generated_at": "2026-02-06T12:00:00Z",
      "root": ".",
      "files": []
    }
  }
}
