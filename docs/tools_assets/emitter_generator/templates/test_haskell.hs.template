-- | Tests for {{CATEGORY_TITLE}} Emitter
--
-- Generated by: STUNIR Emitter Generator v1.0

module STUNIR.Emitters.{{CATEGORY_TITLE}}Test where

import Test.Hspec
import STUNIR.Emitters.{{CATEGORY_TITLE}}
import qualified Data.Text as T

spec :: Spec
spec = do
  describe "{{CATEGORY_TITLE}} Emitter" $ do
    it "maps IR types correctly" $ do
      mapIRType "i32" `shouldBe` "int32"
      mapIRType "bool" `shouldBe` "boolean"
      mapIRType "string" `shouldBe` "string"
    
    it "emits function code" $ do
      let code = emitFunction "test_func" "a, b" "    return a + b;"
      code `shouldSatisfy` T.isInfixOf "function test_func"
    
    it "emits module code" $ do
      let result = emit{{CATEGORY_TITLE}} "test_module" default{{CATEGORY_TITLE}}Config
      case result of
        Right code -> do
          code `shouldSatisfy` T.isInfixOf "STUNIR Generated"
          code `shouldSatisfy` T.isInfixOf "test_module"
          code `shouldSatisfy` T.isInfixOf "Haskell Pipeline"
        Left err -> expectationFailure $ "Emission failed: " ++ show err
