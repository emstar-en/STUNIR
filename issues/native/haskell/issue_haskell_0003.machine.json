{"category":["native","haskell"],"evidence":[{"lines":{"end":53,"start":1},"note":"Defines captured tools list (python3, git, bash, sh, make, gcc, cargo) and writes a timestamped JSON lockfile; no Haskell toolchain entries.","path":"tools/discover_toolchain.sh","sha256":"263854bf096f380b654f9651dbd1fa54de1c47e75013e1067e9463297118ccd8","snippet_sha256":"640ffc77778bc055630d2448aa0a59f5c96435af746282e02dfe04754ec91e47"},{"lines":{"end":30,"start":10},"note":"Shows build.sh generating build/local_toolchain.lock.json via tools/discover_toolchain.sh.","path":"scripts/build.sh","sha256":"62e9cfb279b0c0f1519117f570d27e8c40146fb0cef802398765160523f17b58","snippet_sha256":"30dd4de9600832b304d9d76fa38e8941311eaf921808c91fb49d9676b375671d"}],"expected":["Toolchain lock captures Haskell compiler/build tool identity (at least ghc and cabal, optionally stack) including path, sha256 of the binary, and version string.","Lock generation avoids non-deterministic timestamps in strict profiles (or separates 'observed_at' from canonical tool identity).","Receipts for Haskell-native artifacts include the Haskell toolchain identity used to build them."],"id":"ISSUE.HASKELL.0003","impact":{"breaks_build":false,"breaks_local_verify_strict":false,"breaks_receipt_generation":false},"proposed_fixes":[{"description":"Extend tools/discover_toolchain.sh to include ghc and cabal (and stack if used) in the captured TOOLS list and record their sha256/version.","touched_paths":["tools/discover_toolchain.sh"]},{"description":"Define a deterministic/pinnable toolchain lock schema variant for strict mode that either removes timestamps or makes them explicitly non-normative.","touched_paths":["tools/discover_toolchain.sh","tools/verify_build.py"]}],"related":["ISSUE.HASKELL.0001","ISSUE.HASKELL.0002"],"reproduction":["./tools/discover_toolchain.sh build/local_toolchain.lock.json"],"root_causes":[{"details":"Haskell toolchain is not enumerated and therefore cannot be included in receipts/toolchain lock for determinism.","type":"incomplete_toolchain_lock"}],"schema":"stunir.issues.issue.v1","severity":"high","status":"open","symptoms":["tools/discover_toolchain.sh records a tool list that excludes Haskell toolchain components (ghc, cabal, stack).","scripts/build.sh relies on the generated lockfile for build receipts, but cannot capture the Haskell toolchain identity/hashes.","A Haskell-first trust anchor cannot be reproduced/verified without pinning the Haskell compiler and build toolchain."],"title":"Toolchain lock omits GHC/Cabal/Stack: cannot deterministically build and pin stunir-native-hs","workarounds":[{"commands":["ghc --version","cabal --version"],"description":"Until Haskell toolchain is captured, document the exact GHC/Cabal versions used outside the lockfile (non-hermetic)."}]}
