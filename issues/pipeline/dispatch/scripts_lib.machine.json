{"category":["pipeline","dispatch"],"evidence":[{"lines":{"end":47,"start":19},"note":"[RESOLVED] dispatch.sh defines stunir_dispatch; no undefined log_info usage when sourced.","path":"scripts/lib/dispatch.sh","sha256":"ece4e022838fec52a9f6f3efe6d11f0da94d082c684ccd7f0c62ab8aba4ab229","snippet_sha256":"24c3354e6f5462ab0ca6843fa595e547af33c917c8460e6af000fe87304c9327"},{"lines":{"end":90,"start":1},"note":"Invokes stunir_dispatch multiple times; will fail if dispatch library does not define it.","path":"scripts/build.sh","sha256":"62e9cfb279b0c0f1519117f570d27e8c40146fb0cef802398765160523f17b58","snippet_sha256":"149c366769508758d9872a45be3c25399cb747ce47b15e97c61957fcc267104b"}],"expected":["dispatch.sh should define a function or command named stunir_dispatch that routes subcommands to the selected backend(s).","dispatch.sh should not execute logging helpers that are undefined when sourced."],"id":"ISSUE.DISPATCH.0001","impact":{"breaks_build":true,"breaks_local_verify_strict":true,"breaks_receipt_generation":true},"proposed_fixes":[{"description":"Restore a real dispatcher implementation; ensure it defines stunir_dispatch and does not call undefined functions during sourcing.","touched_paths":["scripts/lib/dispatch.sh","scripts/profile3_lib.sh (optional logging)"]}],"related":["ISSUE.BUILD.0001","ISSUE.RECEIPT.0001"],"reproduction":["set -euxo pipefail","./scripts/build.sh"],"root_causes":[{"details":"dispatch.sh appears truncated/placeholder; it sets env flags and sources receipt.sh, but does not define the dispatcher.","type":"regression"},{"details":"log_info is referenced but no definition exists in scripts/ or tools/.","type":"missing_dependency"}],"schema":"stunir.issues.issue.v1","severity":"blocking","status":"closed","symptoms":["Running scripts/build.sh fails because stunir_dispatch is invoked but not defined.","Sourcing scripts/lib/dispatch.sh executes log_info, but log_info is not defined anywhere in repo."],"title":"scripts/lib/dispatch.sh is not a functional dispatch library (stunir_dispatch undefined; log_info undefined)","workarounds":[{"commands":["./scripts/build_docker.sh"],"description":"Use the Docker pipeline (scripts/build_docker.sh), which does not rely on stunir_dispatch."},{"commands":["python3 -B tools/epoch.py --out-json build/epoch.json --print-epoch","python3 -B tools/spec_to_ir.py --spec-root spec --out asm/spec_ir.txt --epoch-json build/epoch.json","python3 -B tools/spec_to_ir_files.py --spec-root spec --out-root asm/ir --epoch-json build/epoch.json --manifest-out receipts/ir_manifest.json","python3 -B tools/gen_provenance.py --epoch $(python3 - <<'PY'\nimport json; print(json.load(open('build/epoch.json'))['selected_epoch'])\nPY) --epoch-source $(python3 - <<'PY'\nimport json; print(json.load(open('build/epoch.json'))['source'])\nPY) --spec-root spec --asm-root asm --out-header build/provenance.h --out-json build/provenance.json","python3 -B tools/record_receipt.py --target asm/spec_ir.txt --receipt receipts/spec_ir.json --status GENERATED_IR --build-epoch $(python3 - <<'PY'\nimport json; print(json.load(open('build/epoch.json'))['selected_epoch'])\nPY) --epoch-json build/epoch.json --inputs build/provenance.json receipts/ir_manifest.json --input-dirs spec asm"],"description":"Invoke the underlying tools directly (Python-based), bypassing scripts/build.sh until dispatch is restored."}]}
